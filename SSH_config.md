________________________________
Сделать
https://serveradmin.ru/centos-7-nastroyka-servera/
Настройка хранения истории в bash_history
Полезным будет внести некоторые изменения в стандартный механизм сохранения истории команд. Он часто выручает, когда надо вспомнить одну из ранее введенных команд. Стандартные настройки имеют некоторые ограничения, которые неудобны. Вот их список:

По-умолчанию, сохраняются только последние 1000 команд. Если их будет больше, то более старые будут удаляться и заменяться новыми.
Не указаны даты выполнения команд, только их список в порядке выполнения.
Файл со списком команд обновляется после завершения сессии. При параллельных сессиях часть команд может быть утеряна.
Сохраняются абсолютно все команды, хотя в хранении некоторых нет никакого смысла.
Список последних выполненных команд хранится в домашней директории пользователя в файле .bash_history (в начале точка). Его можно открыть любым редактором и посмотреть. Для более удобного вывода списка, можно в консоли ввести команду:

# history
и увидеть пронумерованный список. Быстро найти конкретную команду, можно с помощью фильтрации только нужных строк, например вот так:

# history | grep yum
Так мы увидим все варианты запуска команды yum, которые хранятся в истории. Исправим перечисленные недостатки стандартных настроек хранения истории команд в CentOS 7. Для этого нужно отредактировать файл .bashrc, который находится в том же каталоге, что и файл с историей. Добавляем в него следующие строки:

export HISTSIZE=10000
export HISTTIMEFORMAT="%h %d %H:%M:%S "
PROMPT_COMMAND='history -a'
export HISTIGNORE="ls:ll:history:w:htop"
Первый параметр увеличивает размер файла до 10000 строк. Можно сделать и больше, хотя обычно хватает такого размера. Второй параметр указывает, что необходимо сохранять дату и время выполнения команды. Третья строка вынуждает сразу же после выполнения команды сохранять ее в историю. В последней строке мы создаем список исключений для тех команд, запись которых в историю не требуется. Я привел пример самого простого списка. Можете дополнить его на свое усмотрение.

Для применения изменений необходимо разлогиниться и подключиться заново или выполнить команду:

# source ~/.bashrc
________________________________
Полезное
https://habr.com/ru/post/122445/
https://www.shellhacks.com/ru/change-permissions-files-folders-linux-chmod-basics/
________________________________
Настройка ssh
https://sheensay.ru/ssh

1. Права и ключи
https://evilinside.ru/nastrojka-ssh-avtorizacii-po-klyuchu-bez-parolya-v-centos-7/#
https://www.8host.com/blog/nachalnaya-nastrojka-servera-centos-7/
https://www.8host.com/blog/ustanovka-ssh-klyuchej-v-centos-7/
https://www.shellhacks.com/ru/ssh-login-without-password/





Как зайти по паролю при настроенных ключах

Вариант 1
➜  ~ ssh -o PreferredAuthentications=password -o PubkeyAuthentication=no maria@s1
maria@s1's password:
Permission denied, please try again.
maria@s1's password:
Permission denied, please try again.
maria@s1's password:


Вариант 2
➜  ~ ssh-add -d ~/u_maria
Identity removed: /Users/maria.styazhkina/u_maria (maria.styazhkina@maria)
➜  ~ ssh maria@s1
maria@s1's password:
Permission denied, please try again.
maria@s1's password:


2. Выдать root-овые права пользователю maria
Команда sudo – это механизм передачи обычным системным пользователям привилегий администратора. Как правило, такие привилегии доступны только пользователю root.
Для выполнения задач с привилегиями root  нужно начинать команду с sudo. Это полезно по двум причинам: 1) защита системы от разрушающих ошибок, допущенных пользователем; 2)  хранит все запущенные с sudo команды в файле /var/log/secure, который позже можно просмотреть.

  Вариант 1 (без редактирования sudoers)

В системе CentOS все пользователи, состоящие в группе wheel, имеют права sudo
Используйте команду usermod, чтобы добавить пользователя в группу wheel:
# usermod -aG wheel maria
или
# gpasswd -a username wheel

Тестирование настроек sudo
Перейдите в сессию нового системного пользователя:
# su - maria
Теперь попробуйте запустить любую команду, добавив перед ней sudo.
#sudo command_to_run
К примеру, чтобы просмотреть содержимое каталога /root, нужно выполнить:
#sudo ls -la /root

(При первом запуске sudo система запросит пароль текущей учётной записи.
#[sudo] password for username:
После этого команда будет выполнена с правами администратора.) - не запросил пароль, может быть потому что есть ключи


#lid -g wheel
По-умолчанию, эта команда выводит список групп, к которым принадлежит пользователь, но при помощи ключа -g вы можете увидеть список членов какой-либо группы. Вы получите имена пользователей и соответствующие UID пользователей группы wheel. Таким образом вы легко сможете проверить были ли предыдущие команды выполнены успешно и получил лм ваш новый пользователь необходимые права.

******кажется, права надо было назначить не через sudo (уточнить)

P.S.:
не смогла создать каталоги верхнего уровня из-под пользователя maria
[root@89-108-65-9 maria]# lid -g wheel
 maria(uid=1000)
# ls -ld /var/
drwxr-xr-x. 20 root root 4096 Mar 27 17:17 /var/


# sudo mkdir -p /var/www/example.com/html
не создалось
из-под root - нормлаьно создалось

перезапустила сервис SSHD
# systemctl reload sshd.service
заработало




  Вариант 2  (не вносила изменений)

изменить настройки sudo; для этого используйте текстовый редактор CentOS по умолчанию, который называется vi:
# visudo
Найдите раздел User privilege specification, который выглядит так:
  # User privilege specification
  root    ALL=(ALL)       ALL

После строки с привилегиями root внесите следующую строку, которая передаст все привилегии новому пользователю (чтобы начать ввод текста в vi, нажмите i):
  maria    ALL=(ALL)       ALL
Чтобы завершить ввод текста, нажмите Esc; затем введите :, wq, Enter, чтобы сохранить и закрыть файл.

у меня выглядит иначе
## Allow root to run any commands anywhere
root    ALL=(ALL)       ALL

## Allows people in group wheel to run all commands
%wheel  ALL=(ALL)       ALL
ничего не меняла

в общем достаточно дописать в файле
- если даем полный доступ пользователю
maria    ALL=(ALL)       ALL
- если даем доступ группе
%admin ALL=(ALL)ALL

https://centos.name/?page/tipsandtricks/becomingroot




Как настроить пользовательское подключения SSH для упрощения удаленного доступа
http://blog.sedicomm.com/2018/04/08/kak-nastroit-polzovatelskoe-podklyucheniya-ssh-dlya-uproshheniya-udalennogo-dostupa/

3. Забрать права у root?
